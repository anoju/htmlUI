<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>핀치 줌 예제</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        #zoom-container {
            width: 100vw;
            height: 80vh;
            overflow: auto;
            position: relative;
            max-width: 100%;
            max-height: 100%;
        }
        #zoom-content {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
            background:#ddd;
        }
        #zoom-content img{
          max-width: 100%;
          max-height: 100%;
        }
    </style>
</head>
<body>
    <br>
    <br>
    <div id="zoom-container">
        <div id="zoom-content">
          <img src="../img/thumb-temp.jpg" alt="">
        </div>
    </div>
    <br>
    <br>
<script>
const container = document.getElementById('zoom-container');
const content = document.getElementById('zoom-content');
let currentScale = 1;
let initialDistance = 0;
let initialScale = 1;
let lastX = 0;
let lastY = 0;

function initZoom() {
    const img = content.querySelector('img');
    const containerAspect = container.clientWidth / container.clientHeight;
    const imgAspect = img.naturalWidth / img.naturalHeight;

    if (containerAspect > imgAspect) {
        content.style.height = '100%';
        content.style.width = 'auto';
    } else {
        content.style.width = '100%';
        content.style.height = 'auto';
    }

    currentScale = 1;
    content.style.transform = `scale(1)`;
    container.scrollTo(0, 0);
}

container.addEventListener('touchstart', (e) => {
    if (e.touches.length === 2) {
        e.preventDefault();
        initialDistance = getDistance(e.touches[0], e.touches[1]);
        initialScale = currentScale;
    } else if (e.touches.length === 1) {
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
    }
});

container.addEventListener('touchmove', (e) => {
    if (e.touches.length === 2) {
        e.preventDefault();
        const distance = getDistance(e.touches[0], e.touches[1]);
        let scale = initialScale * (distance / initialDistance);
        scale = Math.max(1, Math.min(scale, 4)); // 최소 1배, 최대 4배로 제한

        const rect = content.getBoundingClientRect();
        const centerX = (e.touches[0].clientX + e.touches[1].clientX) / 2 - rect.left;
        const centerY = (e.touches[0].clientY + e.touches[1].clientY) / 2 - rect.top;

        content.style.transformOrigin = `${centerX}px ${centerY}px`;
        content.style.transform = `scale(${scale})`;
        currentScale = scale;
    } else if (e.touches.length === 1) {
        const deltaX = e.touches[0].clientX - lastX;
        const deltaY = e.touches[0].clientY - lastY;
        container.scrollLeft -= deltaX;
        container.scrollTop -= deltaY;
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
    }
});

function getDistance(touch1, touch2) {
    const dx = touch1.clientX - touch2.clientX;
    const dy = touch1.clientY - touch2.clientY;
    return Math.sqrt(dx * dx + dy * dy);
}

window.addEventListener('load', initZoom);
window.addEventListener('resize', initZoom);
</script>
</body>
</html>